<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="utf-8">
		<title>ReefJS Test</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<!-- stylesheets -->
		<style type="text/css">
			body {
				font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;
				font-size: 112.5%;
				margin-left: auto;
				margin-right: auto;
				max-width: 40em;
				width: 88%;
			}
		</style>

		<!-- scripts -->
		<script src="dist/reef.js"></script>
	</head>

	<body>

		<main>
<div id="app"></div>

<script>
    var sourceOfTruth = new Reef(null, {
        data: {
            heading: '',
            items: {
                todos: [
                    'Buy milk',
                    'Bake a birthday cake',
                    'Go apple picking'
                ],
                heading: 'Things'
            }
        },
        lagoon: true
    });

    var wrapper = new Reef('#app', {
        data: sourceOfTruth.data,
        template: function (props) {
            return '<h1 sandwich="tuna">' + (props.items.heading.length > 0 ? props.items.heading : 'Hello, world!') + '</h1><div id="content"></div>';
        },
        attachTo: [sourceOfTruth]
    });

    var app = new Reef('#content', {
        data: sourceOfTruth.data,
        template: function (props) {
            var html = '<h1>Todos</h1><ul sandwich="tuna">';
            var styles = props.heading.length > 4 ? ' style="font-weight: bold; color: rebeccapurple; background-color: gainsboro;"' : '';
            props.items.todos.forEach(function (todo) {
                html += '<li' + styles + '>' + todo + '</li>';
            });
            html += '<input type="text" id="heading"><br>';
            html += '<strong>The title is:</strong> ' + (props.heading.length > 0 ? props.heading : 'Hello, world!');
            html += '</ul>';
            return html;
        },
        attachTo: [wrapper]
    });

    // app.attach(wrapper);
    wrapper.render();

    // Update state on input change
    document.addEventListener('input', function (event) {
        if (!event.target.matches('#heading')) return;
        sourceOfTruth.setData({heading: event.target.value});
    }, false);
</script>		</main>

	</body>
</html>