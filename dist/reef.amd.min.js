/*! Reef v7.6.6 | (c) 2021 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/reef */
define((function(){"use strict";let t=!1;function e(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}function n(e){if(t)throw new Error(e)}function r(t,n){function o(e){for(let n in t)t.hasOwnProperty(n)&&(e[n]=r(t[n]))}let a=e(t);return"object"===a?function(){let t={};return o(t),t}():"array"===a?t.map((function(t){return r(t)})):"map"===a?function(){let e=new Map;for(let[n,o]of t)e.set(n,r(o));return e}():"set"===a?function(){let t=new Set;for(let e of set)t.add(r(e));return t}():"function"===a?function(){let e=t.bind(this);return o(e),e}():"string"!==a||n?t:t.replace(/[^\w-_. ]/gi,(function(t){return"&#"+t.charCodeAt(0)+";"})).replace(/javascript:/gi,"")}function o(t){t.debounce&&window.cancelAnimationFrame(t.debounce),t.debounce=window.requestAnimationFrame((function(){t.render()}))}function a(t){return{get:function(n,r){return["object","array"].indexOf(e(n[r]))>-1?new Proxy(n[r],a(t)):n[r]},set:function(e,n,r){return e[n]===r||(e[n]=r,o(t)),!0}}}let i=["checked","selected","value"];function u(t,e){e.forEach((function(e){if("class"===e.att)t.className=e.value;else if("style"===e.att)t.style.cssText=e.value;else{if(e.att in t)try{t[e.att]=e.value,t[e.att]||0===t[e.att]||(t[e.att]="value"!==e.att||e.value)}catch(t){}try{t.setAttribute(e.att,e.value)}catch(t){}}}))}function c(t,e){e.forEach((function(e){if("class"===e.att)t.className="";else if("style"===e.att)t.style.cssText="";else{if(e.att in t)try{t[e.att]=""}catch(t){}try{t.removeAttribute(e.att)}catch(t){}}}))}function l(t,e){return{att:t,value:e}}function d(t,e){if(1!==t.nodeType)return[];let n=function(t,e){return Array.from(t.attributes).reduce((function(t,n){return i.includes(n.name)&&(!e||"selected"!==n.name)||n.name.length>7&&"default"===n.name.slice(0,7)||t.push(l(n.name,n.value)),t}),[])}(t,e);return function(t,e,n){i.forEach((function(n){e.push(l(n,t.getAttribute(n)))}))}(t,n),n}function f(t){return 3===t.nodeType?"text":8===t.nodeType?"comment":t.tagName.toLowerCase()}function s(t){return t.childNodes&&t.childNodes.length>0?null:t.textContent}function h(t,e,n){let r=Array.from(e.childNodes),o=Array.from(t.childNodes);!function(t,e){let n=t.length-e.length;if(!(n<1))for(;n>0;n--)t[t.length-n].parentNode.removeChild(t[t.length-n])}(r,o),o.forEach((function(t,o){if(!r[o])return function t(e){1===e.nodeType&&(Array.prototype.forEach.call(e.attributes,(function(t){t.name.length<8||"default"!==t.name.slice(0,7)||(u(e,[l(t.name.slice(7).toLowerCase(),t.value)]),c(e,[l(t.name,t.value)]))})),e.childNodes&&Array.from(e.childNodes).forEach((function(e){t(e)})))}(t),void e.appendChild(t.cloneNode(!0));if(f(t)!==f(r[o]))return void r[o].parentNode.replaceChild(t.cloneNode(!0),r[o]);if(function(t,e){let n=d(t,!0),r=d(e),o=r.filter((function(t){return void 0===n.find((function(e){return t.att===e.att}))}));u(e,n.filter((function(t){let e=r.find((function(e){return t.att===e.att}));return void 0===e||e.value!==t.value}))),c(e,o)}(t,r[o]),n.filter((function(e){return 3!==t.nodeType&&t.matches(e)})).length>0)return;let a=s(t);if(a&&a!==s(r[o])&&(r[o].textContent=a),r[o].childNodes.length>0&&t.childNodes.length<1)r[o].innerHTML="";else{if(r[o].childNodes.length<1&&t.childNodes.length>0){let e=document.createDocumentFragment();return h(t,e,n),void r[o].appendChild(e)}t.childNodes.length>0&&h(t,r[o],n)}}))}function m(t,e){t&&t.forEach((function(t){if(t.attached.includes(e))return n(e.elem+" has attached nodes that it is also attached to, creating an infinite loop.");"render"in t&&t.render()}))}function p(t,i){if(!(t||i&&i.lagoon))return n("You did not provide an element to make into a component.");if(!i||!i.template&&!i.lagoon)return n("You did not provide a template for this component.");let u=this,c=function(t,e){return t.setters?t.store?null:t.data:t.data&&!t.store?new Proxy(t.data,a(e)):null}(i,u),l=i.store,d=i.router,f=i.setters,s=i.getters;if(u.debounce=null,Object.defineProperties(u,{elem:{value:t},template:{value:i.template},allowHTML:{value:i.allowHTML},lagoon:{value:i.lagoon},store:{value:l},attached:{value:[]},router:{value:d}}),Object.defineProperty(u,"data",{get:function(){return f?r(c,!0):c},set:function(t){return l||f||(c=new Proxy(t,a(u)),o(u)),!0}}),f&&!l&&Object.defineProperty(u,"do",{value:function(t){if(!f[t])return n("There is no setter with this name.");let e=Array.from(arguments);e[0]=c,f[t].apply(u,e),o(u)}}),s&&!l&&Object.defineProperty(u,"get",{value:function(t){return s[t]?s[t](c):n("There is no getter with this name.")}}),d&&"addComponent"in d&&d.addComponent(u),l&&"attach"in l&&l.attach(u),i.attachTo){("array"===e(i.attachTo)?i.attachTo:[i.attachTo]).forEach((function(t){"attach"in t&&t.attach(u)}))}}return p.Store=function(t){return t.lagoon=!0,new p(null,t)},p.emit=function(t,e,r){let o;if(!t||!e)return n("You did not provide an element or event name.");o=new CustomEvent(e,{bubbles:!0,detail:r}),t.dispatchEvent(o)},p.prototype.render=function(){if(this.lagoon)return void m(this.attached,this);if(!this.template)return n("No template was provided.");let t="string"===e(this.elem)?document.querySelector(this.elem):this.elem;if(!t)return n("The DOM element to render your template into was not found.");let o=r((this.store?this.store.data:this.data)||{},this.allowHTML),a="function"===e(this.template)?this.template(o,this.router?this.router.current:t,t):this.template;if(!["string","number"].includes(e(a)))return;let i=this.attached.map((function(t){return t.elem}));return h(function(t){let e=(new DOMParser).parseFromString(t,"text/html");return e.head&&e.head.childNodes&&e.head.childNodes.length>0&&Array.from(e.head.childNodes).reverse().forEach((function(t){e.body.insertBefore(t,e.body.firstChild)})),e.body||document.createElement("body")}(a),t,i),p.emit(t,"render",o),m(this.attached,this),t},p.prototype.attach=function(t){"array"===e(t)?this.attached.push.apply(this.attached,t):this.attached.push(t)},p.prototype.detach=function(t){let n="array"===e(t)?t:[t],r=this;n.forEach((function(t){let e=r.attached.indexOf(t);e<0||r.attached.splice(e,1)}))},p.debug=function(e){t=!!e},p.clone=r,p._={trueTypeOf:e,err:n},p}));
