/*! reef v1.0.1 | (c) 2018 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/reef */
Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),(function(t,e){"function"==typeof define&&define.amd?define([],(function(){return e(t)})):"object"==typeof exports?module.exports=e(t):t.Reef=e(t)})("undefined"!=typeof global?global:"undefined"!=typeof window?window:this,(function(c){"use strict";var l,u=["for"],r=function(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()},f=function(t){if(t)return JSON.parse(JSON.stringify(t))},s=function(t,e){var n=t.filter(e);return n.length<1?null:n[0]},t=function(t,e){if(!(function(){if(!c.DOMParser)return!1;l=l||new DOMParser;try{l.parseFromString("x","text/html")}catch(t){return!1}return!0})())throw new Error("Reef.js is not supported by this browser.");if(!(t||e&&e.lagoon))throw new Error("Reef.js: You did not provide an element to make into a component.");if(!e||!e.template&&!e.lagoon)throw new Error("Reef.js: You did not provide a template for this component.");if(this.elem=t,this.data=e.data,this.template=e.template,this.attached=[],this.lagoon=e.lagoon,e.attachTo){var n=this;e.attachTo.forEach((function(t){"attach"in t&&t.attach(n)}))}},h=function(e,t){t.forEach((function(t){e.style[t]=""}))},a=function(c,t){t.forEach((function(t){var e,n,r,o,a,i;"class"===t.att?c.className=t.value:"style"===t.att?(n=c,r=t.value,a=r.split(";").filter((function(t){return 0<t.indexOf(":")})).map((function(t){var e=t.split(":");return{name:e[0]?e[0].trim():"",value:e[1]?e[1].trim():""}})),i=Array.prototype.filter.call(n.style,(function(e){return null===s(a,(function(t){return t.name===e&&t.value===n.style[e]}))})),h(n,i),o=n,a.forEach((function(t){o.style[t.name]=t.value}))):"data-"===(e=t.att).slice(0,5)||-1<u.indexOf(e)?c.setAttribute(t.att,t.value):c[t.att]=t.value}))},i=function(t){var e="text"===t.type?document.createTextNode(t.content):document.createElement(t.type);return a(e,t.atts),0<t.children.length?t.children.forEach((function(t){e.appendChild(i(t))})):"text"!==t.type&&(e.textContent=t.content),e},d=function(t,n){var e,r=n.atts.filter((function(e){return null===s(t.atts,(function(t){return e.att===t.att}))})),o=t.atts.filter((function(e){var t=s(n.atts,(function(t){return e.att===t.att}));return null===t||t.value!==e.value}));a(n.node,o),e=n.node,r.forEach((function(t){"class"===t.att?e.className="":"style"===t.att?h(e,Array.prototype.slice.call(e.style)):e.removeAttribute(t.att)}))},p=function(n,r,o,a){var t=r.length-n.length;if(0<t)for(;0<t;t--)r[r.length-t].node.parentNode.removeChild(r[r.length-t].node);n.forEach((function(e,t){r[t]?n[t].type===r[t].type?(d(n[t],r[t],r[t].node),0<a.filter((function(t){return 3!==e.node.nodeType&&e.node.matches(t)})).length||(n[t].content!==r[t].content&&(r[t].node.textContent=n[t].content),0<e.children.length&&p(e.children,r[t].children||[],r[t].node,a))):r[t].node.parentNode.replaceChild(i(n[t]),r[t].node):o.appendChild(i(n[t]))}))},y=function(t){var n=[];return Array.prototype.forEach.call(t.childNodes,(function(t){var e;n.push({content:t.childNodes&&0<t.childNodes.length?null:t.textContent,atts:3===t.nodeType?[]:(e=t.attributes,Array.prototype.map.call(e,(function(t){return{att:t.name,value:t.value}}))),type:3===t.nodeType?"text":t.tagName.toLowerCase(),children:y(t),node:t})})),n},m=function(t,e){t&&t.forEach((function(t){if(-1<t.attached.indexOf(e))throw new Error("ReefJS: "+e.elem+" has attached nodes that it is also attached to, creating an infinite loop.");"render"in t&&t.render()}))};return t.prototype.render=function(){if(this.lagoon)m(this.attached,this);else{if(!this.template)throw new Error("Reef.js: No template was provided.");var t="string"==typeof this.elem?document.querySelector(this.elem):this.elem;if(!t)throw new Error("Reef.js: The DOM element to render your template into was not found.");var e="function"==typeof this.template?this.template(f(this.data)):this.template;if(-1!==["string","number"].indexOf(typeof e)){var n,r=y((n=e,(l=l||new DOMParser).parseFromString(n,"text/html").body),a),o=y(t,a),a=this.attached.map((function(t){return t.elem}));if(p(r,o,t,a),"function"==typeof c.CustomEvent){var i=new CustomEvent("render",{bubbles:!0});t.dispatchEvent(i)}return m(this.attached,this),t}}},t.prototype.getData=function(){return f(this.data)},t.prototype.setData=function(t){if("object"!==r(t))throw new Error("ReefJS: The provided data is not an object.");for(var e in t)t.hasOwnProperty(e)&&(this.data[e]=t[e]);this.render()},t.addAttributes=function(t){"array"===r(t)?Array.prototype.push.apply(u,t):u.push(t)},t.removeAttributes=function(e){var n="array"===r(e);u=u.filter((function(t){return n?-1===e.indexOf(t):t!==e}))},t.prototype.attach=function(t){"array"===r(t)?Array.prototype.push.apply(this.attached,t):this.attached.push(t)},t.prototype.detach=function(e){var n="array"===r(e);this.attached=this.attached.filter((function(t){return n?-1===e.indexOf(t):t!==e}))},t}));