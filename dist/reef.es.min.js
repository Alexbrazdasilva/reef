/*! Reef v9.0.1 | (c) 2021 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/reef */
let e=!1;function t(t){e&&console.warn(t)}function n(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function r(e){return["false","null","undefined","0","-0","NaN","0n","-0n"].includes(e)}function o(e,t,n,r){let o;return e&&t?(o=new CustomEvent(t,{bubbles:!0,cancelable:!r,detail:n}),e.dispatchEvent(o)):_.err("You did not provide an element or event name.")}function i(e,t){function r(n){for(let r in e)e.hasOwnProperty(r)&&(n[r]=i(e[r],t))}let o=n(e);return"object"===o?function(){let e={};return r(e),e}():"array"===o?e.map((function(e){return i(e,t)})):"map"===o?function(){let n=new Map;for(let[r,o]of e)n.set(r,i(o,t));return n}():"set"===o?function(){let e=new Set;for(let n of set)e.add(i(n,t));return e}():"function"===o?function(){let t=e.bind(this);return r(t),t}():"string"!==o||t?e:e.replace(/javascript:/gi,"").replace(/[^\w-_. ]/gi,(function(e){return`&#${e.charCodeAt(0)};`}))}function a(e){e.debounce&&window.cancelAnimationFrame(e.debounce),e.debounce=window.requestAnimationFrame((function(){e.render()}))}function l(e){return{get:function(t,r){return["object","array"].indexOf(n(t[r]))>-1?new Proxy(t[r],l(e)):t[r]},set:function(t,n,r){return t[n]===r||(t[n]=r,a(e)),!0},deleteProperty:function(t,n){return delete t[n],a(e),!0}}}let u=["input","option","textarea"],c=["value","checked","selected"],d=["checked","selected"];function f(e,t,n){c.includes(t)&&(e[t]="value"===t?n:" "),e.setAttribute(t,n)}function s(e,t){c.includes(t)&&(e[t]=""),e.removeAttribute(t)}function h(e){if(1===e.nodeType){for(let t of e.attributes){if("reef-"!==t.name.slice(0,5))continue;let n=t.name.replace("reef-default-","").replace("reef-","");s(e,t.name),d.includes(n)&&r(t.value)||f(e,n,t.value)}if(e.childNodes)for(let t of e.childNodes)h(t)}}function m(e){return e.childNodes&&e.childNodes.length?null:e.textContent}function p(e,t){return e.nodeType!==t.nodeType||e.tagName!==t.tagName||e.id!==t.id||e.src!==t.src}function g(e,t,n=[]){let o=e.childNodes,i=t.childNodes;o.forEach((function(e,o){if(!i[o])return h(e),void t.append(e.cloneNode(!0));if(p(e,i[o])){let t=function(e,t,n){return Array.from(t).slice(n+1).find((function(t){return!p(e,t)}))}(e,i,o);if(!t)return h(e),void i[o].before(e.cloneNode(!0));i[o].before(t)}if(n.filter((function(t){return![3,8].includes(e.nodeType)&&e.matches(t)})).length>0)return;let a=m(e);if(a&&a!==m(i[o])&&(i[o].textContent=a),function(e,t){if(1!==e.nodeType)return;let n=e.attributes,o=t.attributes;for(let o of n){if("reef-default-"===o.name.slice(0,13))continue;if(c.includes(o.name)&&u.includes(e.tagName.toLowerCase()))continue;let n=o.name.replace("reef-","");if(d.includes(n)&&r(o.value))return void s(t,n);f(t,n,o.value)}for(let e of o)n[e.name]||c.includes(e.name)&&u.includes(t.tagName.toLowerCase())||s(t,e.name)}(e,i[o]),e.childNodes.length||!i[o].childNodes.length){if(!i[o].childNodes.length&&e.childNodes.length){let t=document.createDocumentFragment();return g(e,t,n),void i[o].appendChild(t)}e.childNodes.length&&g(e,i[o],n)}else i[o].innerHTML=""})),function(e,t){let n=e.length-t.length;if(!(n<1))for(;n>0;n--)e[e.length-1].remove()}(i,o)}function y(e,n){if(e)for(let r of e){if(r.attached.includes(n))return t(`"${n.elem}" has attached nodes that it is also attached to, creating an infinite loop.`);"render"in r&&r.render()}}function v(e,r={}){if(!e&&!r.lagoon)return t("You did not provide an element to make into a component.");if(!r.template&&!r.lagoon)return t("You did not provide a template for this component.");let u=this,c=function(e,t){return e.setters?e.store?null:e.data:e.data&&!e.store?new Proxy(e.data,l(t)):null}(r,u),d=r.attachTo?"array"===n(r.attachTo)?r.attachTo:[r.attachTo]:[],{store:f,setters:s,getters:h}=r;u.debounce=null,Object.defineProperties(u,{elem:{value:e},template:{value:r.template},allowHTML:{value:r.allowHTML},lagoon:{value:r.lagoon},store:{value:f},attached:{value:[]},data:{get:function(){return s?i(c,!0):c},set:function(e){return f||s||(c=new Proxy(e,l(u)),a(u)),!0},configurable:!0},do:{value:function(e){if(f||!s)return t("There are no setters for this component.");if(!s[e])return t("There is no setter with this name.");let n=Array.from(arguments);n[0]=c,s[e].apply(u,n),a(u)}},get:{value:function(e){if(f||!h)return t("There are no getters for this component.");if(!h[e])return t("There is no getter with this name.");let n=Array.from(arguments);return n[0]=c,h[e].apply(u,n)}}}),f&&"attach"in f&&f.attach(u),d.length&&d.forEach((function(e){"attach"in e&&e.attach(u)})),o(document,"reef:initialized",u)}v.prototype.render=function(){if(this.lagoon)return void y(this.attached,this);if(!this.template)return t("No template was provided.");let e="string"===n(this.elem)?document.querySelector(this.elem):this.elem;if(!e)return t("The DOM element to render your template into was not found.");let r=i((this.store?this.store.data:this.data)||{},this.allowHTML),a="function"===n(this.template)?this.template(r,e):this.template;if(!["string","number"].includes(n(a)))return;if(!o(e,"reef:before-render",r))return;let l=this.attached.map((function(e){return e.elem}));return g(function(e){let t=(new DOMParser).parseFromString(e,"text/html");return t.head&&t.head.childNodes&&t.head.childNodes.length>0&&Array.from(t.head.childNodes).reverse().forEach((function(e){t.body.insertBefore(e,t.body.firstChild)})),t.body||document.createElement("body")}(a),e,l),o(e,"reef:render",r),y(this.attached,this),e},v.prototype.attach=function(e){let t="array"===n(e)?e:[e];for(let e of t)this.attached.push(e);o(document,"reef:attached",{component:this,attached:t})},v.prototype.detach=function(e){let t="array"===n(e)?e:[e];for(let e of t){let t=this.attached.indexOf(e);if(t<0)return;this.attached.splice(t,1)}o(document,"reef:detached",{component:this,detached:t})},v.Store=function(e){return e.lagoon=!0,new v(null,e)},v.debug=function(t){e=!!t},v.clone=i,v.emit=o,v.err=t,o(document,"reef:ready");export default v;
