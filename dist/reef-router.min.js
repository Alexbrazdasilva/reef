/*! Reef v7.0.1 | (c) 2020 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/reef */
!function(){"use strict";var e=/([:*])(\w+)/g,t=/\*/g,r="([^/]+)",n="(?:.*)",o="(?:/$|$)",i="",a=!!window.history&&!!window.history.pushState,u=function(e){return e.replace(/^\/|\/$/g,"")},c=function(a,c){if(!c||"array"!==Reef._.trueTypeOf(c))return[];if(!a.length){var f=function(e){var t=e.filter((function(e){return"/"===e.url}));if(t.length)return[{route:t[0],params:{}}]}(c);if(f)return f}return c.map((function(c){var f=function(a){var u=[];return{regexp:new RegExp(a.replace(e,(function(e,t,n){return u.push(n),r})).replace(t,n)+o,i),paramNames:u}}(u(c.url)),s=a.replace(/^\/+/,"/").match(f.regexp);if(s)return{route:c,params:function(e,t){return e&&0!==t.length?e.slice(1,e.length).reduce((function(e,r,n){return e[t[n]]=decodeURIComponent(r),e}),{}):{}}(s,f.paramNames)}})).filter((function(e){return e}))},f=function(e,t,r){var n=function(e,t){if(!t.length)return u(e.pathname);t=u(t);var r=u(e.pathname);return 0===r.indexOf(t)&&(r=r.slice(t.length)),r}(e,r),o=c(n,t);if(o.length){var i=Reef.clone(o[0].route);return i.params=o[0].params,i.search=function(e){var t={},r=e.search.substring(1).split("&");if(r.length<1||r[0].length<1)return t;for(var n=0;n<r.length;n++){var o=r[n].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}(e),i}},s=function(e,t){Reef.emit(window,"beforeRouteUpdated",{current:e,next:t})},h=function(e,t){Reef.emit(window,"routeUpdated",{current:e,previous:t})},l=function(e,t){if(e&&e.title){var r="function"==typeof t.title?t.title(e):t.title;document.title=r.replace("{{title}}",e.title)}},d=function(e,t){var r;t._components.forEach((function(e){"render"in e&&e.render()})),l(e,t),(r=document.querySelector("h1, h2, h3, h4, h5, h6"))&&(r.setAttribute("tabindex","-1"),r.focus())},p=function(e,t){if(t.hash&&(t.hashing=!0),t.hash&&e.hash.length){var r=document.getElementById(e.hash.slice(1));return window.location.hash+=e.hash,void r.scrollIntoView()}var n=f(e,t.routes,t.root),o=t.current;s(o,n),t.current=n;var i=u(e.getAttribute("href"));t.hash?window.location.hash="!/"+i:history.pushState(n||{},n&&n.title?n.title:"","/"+i),d(n,t),h(n,o)},v=function(e,t){var r=document.createElement("a");return r.href=(t.length?"/"+u(t):"")+"/"+u(e),r},m=function(e,t){if(!(e.metaKey||e.ctrlKey||e.shiftKey||e.defaultPrevented)){var r,n=function(e){var t=e.target;if("closest"in t)return t.closest("a");var r=e.path||(e.composedPath?e.composedPath():null);if(r)for(var n=0;n<r.length;n++)if(r[n].nodeName&&"a"===r[n].nodeName.toLowerCase()&&r[n].href)return r[n]}(e);if(n)if(!(n.hasAttribute("download")||"external"===n.getAttribute("rel")||n.href.indexOf("mailto:")>-1))if((r=n).pathname!==window.location.pathname||r.search!==window.location.search||t.hash||!n.hash.length)e.preventDefault(),p(n,t)}};Reef.Router=function(e){if(!e||!e.routes||"array"!==Reef._.trueTypeOf(e.routes)||!e.routes.length)return Reef._.err("Please provide an array of routes.");var t=this,r=e.routes,n=e.root?e.root:"",o=e.title?e.title:"{{title}}",i=f(window.location,r,n),u=[],c=e.useHash||!a||"file:"===window.location.protocol;t._hashing=!1;Object.defineProperties(t,{routes:{value:Reef.clone(r,!0)},root:{value:n},title:{value:o},hash:{value:c}}),Object.defineProperty(t,"current",{get:function(){return Reef.clone(i,!0)},set:function(e){return i=e,!0}}),Object.defineProperty(t,"_routes",{set:function(e){return r=e,!0}}),Object.defineProperty(t,"_components",{get:function(){return u}}),l(i,t),document.addEventListener("click",(function(e){m(e,t)})),c?window.addEventListener("hashchange",(function(e){!function(e,t){if(t.hashing)t.hashing=!1;else{var r=v(window.location.hash.slice(2),t.root),n=(r.getAttribute("href"),f(r,t.routes,t.root)),o=t.current;s(o,n),t.current=n,d(n,t),h(n,o)}}(0,t)})):(history.replaceState(i,document.title,window.location.href),window.addEventListener("popstate",(function(e){!function(e,t){if(e.state){var r=t.current;s(r,e.state),t.current=e.state,d(t.current,t),h(e.state,r)}else history.replaceState(t.current,document.title,window.location.href)}(e,t)})))},Reef.Router.prototype.addRoutes=function(e){var t=Reef._.trueTypeOf(e);if(["array","object"].indexOf(t)<0)return Reef._.err("Please provide a valid route or routes.");var r=this.routes;"object"===t?r.push(e):r.concat(e),this._routes=r},Reef.Router.prototype.addComponent=function(e){this._components.push(e)},Reef.Router.prototype.navigate=function(e){p(v(e,this.root),this)}}();
