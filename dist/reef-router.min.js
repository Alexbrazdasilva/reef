/*! Reef v7.0.1 | (c) 2020 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/reef */
!function(){"use strict";var e=/([:*])(\w+)/g,t=/\*/g,r="([^/]+)",n="(?:.*)",o="(?:/$|$)",i="",u=!!window.history&&!!window.history.pushState,a=function(e){return e.replace(/^\/|\/$/g,"")},c=function(u,c){if(!c||"array"!==Reef._.trueTypeOf(c))return[];if(!u.length){var f=function(e){var t=e.filter((function(e){return"/"===e.url}));if(t.length)return[{route:t[0],params:{}}]}(c);if(f)return f}return c.map((function(c){var f=function(u){var a=[];return{regexp:new RegExp(u.replace(e,(function(e,t,n){return a.push(n),r})).replace(t,n)+o,i),paramNames:a}}(a(c.url)),s=u.replace(/^\/+/,"/").match(f.regexp);if(s)return{route:c,params:function(e,t){return e&&0!==t.length?e.slice(1,e.length).reduce((function(e,r,n){return e[t[n]]=decodeURIComponent(r),e}),{}):{}}(s,f.paramNames)}})).filter((function(e){return e}))},f=function(e,t,r){var n=function(e,t){if(!t.length)return e.pathname;t=a(t);var r=a(e.pathname);return 0===r.indexOf(t)&&(r=r.slice(t.length)),r}(e,r),o=c(n,t);if(o.length){var i=Reef.clone(o[0].route);return i.params=o[0].params,i.search=function(e){var t={},r=e.search.substring(1).split("&");if(r.length<1||r[0].length<1)return t;for(var n=0;n<r.length;n++){var o=r[n].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}(e),i}},s=function(e,t){Reef.emit(window,"beforeRouteUpdated",{current:e,next:t})},l=function(e,t){Reef.emit(window,"routeUpdated",{current:e,previous:t})},p=function(e,t){if(e&&e.title){var r="function"==typeof t.title?t.title(e):t.title;document.title=r.replace("{{title}}",e.title)}},d=function(e,t){var r;t._components.forEach((function(e){"render"in e&&e.render()})),p(e,t),(r=document.querySelector("h1, h2, h3, h4, h5, h6"))&&(r.setAttribute("tabindex","-1"),r.focus())},h=function(e,t){var r=f(e,t.routes,t.root),n=t.current;s(n,r),t.current=r,history.pushState(r||{},r&&r.title?r.title:"",e.getAttribute("href")),d(r,t),l(r,n)},m=function(e,t){if(!(e.metaKey||e.ctrlKey||e.shiftKey||e.defaultPrevented)){var r,n=function(e){var t=e.target;if("closest"in t)return t.closest("a");var r=e.path||(e.composedPath?e.composedPath():null);if(r)for(var n=0;n<r.length;n++)if(r[n].nodeName&&"a"===r[n].nodeName.toLowerCase()&&r[n].href)return r[n]}(e);if(n)if(!n.hasAttribute("download")&&"external"!==n.getAttribute("rel"))if(!((r=n).pathname===window.location.pathname&&r.search===window.location.search||n.href.indexOf("mailto:")>-1))e.preventDefault(),h(n,t)}};Reef.Router=function(e){if(!e||!e.routes||"array"!==Reef._.trueTypeOf(e.routes)||!e.routes.length)return Reef._.err("Please provide an array of routes.");var t=this,r=e.routes,n=e.root?e.root:"",o=e.title?e.title:"{{title}}",i=f(window.location,r,n),a=[];Object.defineProperties(t,{routes:{value:Reef.clone(r,!0)},root:{value:n},title:{value:o}}),Object.defineProperty(t,"current",{get:function(){return Reef.clone(i,!0)},set:function(e){return i=e,!0}}),Object.defineProperty(t,"_routes",{set:function(e){return r=e,!0}}),Object.defineProperty(t,"_components",{get:function(){return a}}),p(i,t),u&&(history.replaceState(i,document.title,window.location.href),document.addEventListener("click",(function(e){m(e,t)})),window.addEventListener("popstate",(function(e){!function(e,t){if(e.state){var r=t.current;s(r,e.state),t.current=e.state,d(t.current,t),l(e.state,r)}else history.replaceState(t.current,document.title,window.location.href)}(e,t)})))},Reef.Router.prototype.addRoutes=function(e){var t=Reef._.trueTypeOf(e);if(["array","object"].indexOf(t)<0)return Reef._.err("Please provide a valid route or routes.");var r=this.routes;"object"===t?r.push(e):r.concat(e),this._routes=r},Reef.Router.prototype.addComponent=function(e){this._components.push(e)},Reef.Router.prototype.navigate=function(e){var t=document.createElement("a");t.href="/"+a(this.root)+"/"+a(e),h(t,this)}}();
